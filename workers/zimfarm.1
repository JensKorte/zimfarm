.\" Automatically generated by Pandoc 2.2.1
.\"
.TH "zimfarm" "1" "2020\-03\-14" "" ""
.hy
.SH Name
.PP
zimfarm \- the zimfarm worker manager script to manage the build process
of zim files hosted at <https://kiwix.org>
.SH Synopsis
.PP
zimfarm <command> [option]
.SH Description
.PP
With this script you can start/stop the worker and the manager, list the
containers, read logs, remove all docker containers/images/volums and
update the script itself.
.PP
zimfarm is provided for your comfort only.
A Zimfarm worker is just a Docker container spawning other containers
that download recipes (instructions) and build the zim file.
If you like to control everything, you can run it manually setting the
appropriate options.
Otherwise, use our handy bash script.
.SH Commands
.SS starting, stopping, restarting the manager and the worker
.IP \[bu] 2
\f[B]start\f[] or \f[B]restart\f[]: (re)start pulls a new version of the
Docker image and also reapplies the configuration.
The worker is not restarted, the task is not canceled and the work for
the actual zim file is not lost.
.PD 0
.P
.PD
.IP \[bu] 2
\f[B]stop manager\f[]: stops the manager without stopping the currently
running workers.
A stopped manager doesn't receive new task to do.
The running task(s) is/are completed and uploaded but your worker is not
listed any more at <https://farm.openzim.org/workers>.
.PD 0
.P
.PD
.IP \[bu] 2
\f[B]stop <task\-name>\f[] stops a task and its dependencies (scraper,
dnscache).
Marks it as canceled.
Can take a minute.
.PD 0
.P
.PD
.IP \[bu] 2
\f[B]shutdown\f[]: stops the manager and all the running tasks.
Use this to stop the worker completely.
Running tasks will be marked as canceled.
Can take a couple minutes.
.SS gathering information
.IP \[bu] 2
\f[B]ps [parameters]\f[]: displays a list of running containers with
Zimfarm labels.
Optionnal: pass parameter to ps (\-a, \-nX).
.PD 0
.P
.PD
.IP \[bu] 2
\f[B]logs <name> [n]\f[]: displays logs.
<name> can be `manager' or a task.
n is an optionnal lines number (default: 100).
.PD 0
.P
.PD
.IP \[bu] 2
\f[B]inspect <name>\f[]: inspect details of the `manager' or container.
.PD 0
.P
.PD
.IP \[bu] 2
\f[B]config\f[]: show the config file path and the search paths.
.SS housekeeping
.IP \[bu] 2
\f[B]update\f[]: displays a command you could use update this very
script.
.PD 0
.P
.PD
.IP \[bu] 2
\f[B]update do\f[]: attempt to run the \f[C]zimfarm\ update\f[] command.
.PD 0
.P
.PD
.IP \[bu] 2
\f[B]prune\f[]: removes unused containers and volumes to save space.
You can put that in a daily cron task.
.SH See also
.IP \[bu] 2
config file: zimfarm.config (search path:
/usr/local/bin/zimfarm.config:./.zimfarm.config:./zimfarm.config:/etc/zimfarm.config)
.PD 0
.P
.PD
.IP \[bu] 2
website: <https://github.com/openzim/zimfarm/>
.PD 0
.P
.PD
.IP \[bu] 2
overview and stats on the workers and recipes:
<https://farm.openzim.org/>
.PD 0
.P
.PD
.IP \[bu] 2
available zim files:
<https://wiki.kiwix.org/wiki/Content_in_all_languages>
.SH AUTHORS
Jens Korte and other.
